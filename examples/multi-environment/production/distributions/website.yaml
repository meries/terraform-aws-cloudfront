enabled: true
comment: "Production Website Distribution"
price_class: "PriceClass_All" # Global coverage
default_root_object: "index.html"
ipv6_enabled: true

aliases:
  - www.example.com
  - example.com

certificate:
  acm_certificate_arn: "arn:aws:acm:us-east-1:123456789012:certificate/prod-cert-id"

# Production WAF
web_acl_id: "arn:aws:wafv2:us-east-1:123456789012:global/webacl/prod-waf/a1b2c3d4-5678-90ab-cdef-EXAMPLE11111"

origins:
  - id: prod-s3-origin
    domain_name: prod-website-bucket.s3.eu-west-1.amazonaws.com
    type: s3
    # Production uses Origin Shield for better cache hit ratio
    origin_shield:
      enabled: true
      region: eu-west-1

  - id: prod-api-origin
    domain_name: api.example.com
    type: custom
    custom_origin_config:
      http_port: 80
      https_port: 443
      origin_protocol_policy: https-only
      origin_ssl_protocols: [TLSv1.2]
      origin_read_timeout: 60
      origin_keepalive_timeout: 5

default_behavior:
  target_origin_id: prod-s3-origin
  viewer_protocol_policy: redirect-to-https
  cache_policy_name: "website-cache"
  response_headers_policy_name: "security-headers-strict"

  function_associations:
    - event_type: viewer-request
      function_name: url-rewrite

  # Optional: Lambda@Edge for advanced auth (example)
  # lambda_associations:
  #   - event_type: viewer-request
  #     lambda_arn: "arn:aws:lambda:us-east-1:123456789012:function:auth:1"

# Ordered cache behaviors with specific optimizations
behaviors:
  - path_pattern: "/api/*"
    target_origin_id: prod-api-origin
    viewer_protocol_policy: https-only
    cache_policy_name: "api-cache"
    origin_request_policy_name: "api-origin-request"
    response_headers_policy_name: "security-headers-strict"
    allowed_methods: [GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE]

  - path_pattern: "/static/*"
    target_origin_id: prod-s3-origin
    viewer_protocol_policy: redirect-to-https
    cache_policy_name: "static-assets-cache"
    response_headers_policy_name: "cors-headers"

  - path_pattern: "*.jpg"
    target_origin_id: prod-s3-origin
    viewer_protocol_policy: redirect-to-https
    cache_policy_name: "images-cache"

  - path_pattern: "*.png"
    target_origin_id: prod-s3-origin
    viewer_protocol_policy: redirect-to-https
    cache_policy_name: "images-cache"

# Production logging
logging:
  bucket: "prod-cloudfront-logs.s3.amazonaws.com"
  prefix: "cloudfront/website/"
  include_cookies: false

# Custom error responses for production
custom_error_responses:
  - error_code: 404
    response_code: 404
    response_page_path: "/404.html"
    error_caching_min_ttl: 300

  - error_code: 403
    response_code: 403
    response_page_path: "/403.html"
    error_caching_min_ttl: 300

  - error_code: 500
    response_code: 500
    response_page_path: "/500.html"
    error_caching_min_ttl: 60

  - error_code: 503
    response_code: 503
    response_page_path: "/503.html"
    error_caching_min_ttl: 60

# Geographic restrictions (example - uncomment if needed)
# geo_restriction:
#   restriction_type: whitelist
#   locations: [US, CA, GB, FR, DE]

# Enable additional metrics for production monitoring
enable_additional_metrics: true
